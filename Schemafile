create_table :users, options: 'ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin ROW_FORMAT=DYNAMIC' do |t|
  t.string :email, null: false
  t.string :encrypted_password, null: false, default: ''
  t.integer  :sign_in_count, null: false, default: 0
  t.datetime :current_sign_in_at
  t.datetime :last_sign_in_at
  t.string   :current_sign_in_ip
  t.string   :last_sign_in_ip
  t.timestamps null: false

  t.index :email, unique: true
end

create_table :crawler_jobs, options: 'ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin ROW_FORMAT=DYNAMIC' do |t|
  # t.integer :user_id, null: false
  t.string :name, null: false, default: ''
  t.string :site, null: false
  t.string :status, null: false
  t.text :url, null: false
  t.text :url_list, null: false
  t.text :page_title, null: false
  t.integer :total_count, null: false, default: 0
  t.text :error_message, null: false
  t.datetime :started_at
  t.datetime :completed_at
  t.timestamps null: false
end

create_table :web_pages, options: 'ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin ROW_FORMAT=DYNAMIC' do |t|
  t.integer :crawler_job_id, null: false
  t.text :url, null: false
  t.longtext :body, null: false
  t.text :error_message, null: false
  t.datetime :fetched_at
  t.timestamps null: false

  t.index :crawler_job_id
  t.index [:crawler_job_id, :url], unique: true, length: { url: 255 }
end
